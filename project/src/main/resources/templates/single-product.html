<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${product.name}">Product Detail</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" th:href="@{/css/vendor.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/style.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500&family=Marcellus&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Header -->
    <div th:replace="~{index :: #header-nav}"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="product-image">
                        <img th:src="@{'/' + ${product.imageUrl}}" alt="Product Image" class="img-fluid" style="height: auto; max-height: 700px; object-fit: cover;">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="product-info">
                        <h2 class="product-title" th:text="${product.name}">Product Name</h2>
                        <div class="product-price">
                            <strong th:text="'$' + ${#numbers.formatDecimal(product.price, 1, 'COMMA', 2, 'POINT')}">$95.00</strong>
                        </div>
                        <div class="rating-container my-3">
                            <span class="rating" th:if="${product.rating != null}" th:text="${#numbers.formatDecimal(product.rating, 1, 1)} + ' ★'">4.5 ★</span>
                            <span class="review-count ms-2" th:text="'(' + ${product.stockQuantity} + ' in stock)'">(50 in stock)</span>
                        </div>
                        <p class="product-description" th:text="${product.description}">
                            A beautiful dark florish onepiece, perfect for any occasion. Made with high-quality fabric for comfort and style.
                        </p>
                        <hr>
                        <div class="product-meta">
                            <p><strong>SKU:</strong> <span th:text="'SKU' + ${product.id}">SKU123</span></p>
                            <p><strong>Category:</strong> <a th:href="@{'/shop/' + ${product.category}}" th:text="${product.category}">Clothes</a></p>
                            <p><strong>Material:</strong> <span th:text="${product.material}">Polyester</span></p>
                            <p><strong>Color:</strong> <span th:text="${product.color}">Black</span></p>
                        </div>
                        <hr>
                        <div class="product-options">
                            <div class="swatch-container mb-3" th:if="${product.availableSizes != null and !#strings.isEmpty(product.availableSizes)}">
                                <h5>Size:</h5>
                                <div class="swatch-element" th:each="size, iterStat : ${#strings.arraySplit(product.availableSizes, ',')}">
                                    <input type="radio" name="size" th:id="'size-' + ${size}" th:value="${size}" class="swatch-input" th:checked="${iterStat.index == 0}">
                                    <label th:for="'size-' + ${size}" class="swatch-label" th:text="${size}">S</label>
                                </div>
                            </div>
                            <div class="product-quantity my-4">
                                <h5>Quantity:</h5>
                                <div class="input-group" style="width: 150px;">
                                    <button class="btn btn-outline-secondary" type="button" id="button-minus">-</button>
                                    <input type="text" class="form-control text-center" value="1" id="quantity-input">
                                    <button class="btn btn-outline-secondary" type="button" id="button-plus">+</button>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-dark btn-lg text-uppercase">Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Related Products Section -->
    <section id="related-products" class="related-products product-carousel py-5 position-relative overflow-hidden" th:if="${relatedProducts != null and !relatedProducts.isEmpty()}">
        <div class="container">
            <div class="d-flex flex-wrap justify-content-between align-items-center mt-5 mb-3">
                <h4 class="text-uppercase">Related Products</h4>
            </div>
            <div class="swiper product-swiper">
                <div class="swiper-wrapper d-flex">
                    <div class="swiper-slide" th:each="related : ${relatedProducts}">
                        <div class="product-item image-zoom-effect link-effect d-flex flex-column h-100">
                            <div class="image-holder position-relative">
                                <a th:href="@{/product/{id}(id=${related.id})}">
                                    <img th:src="@{'/' + ${related.imageUrl}}" alt="product-item" class="product-image img-fluid">
                                </a>
                            </div>
                            <div class="product-content d-flex flex-column flex-grow-1 px-3 pb-3">
                                <h5 class="element-title text-uppercase fs-5 mt-3 flex-grow-1">
                                    <a th:href="@{/product/{id}(id=${related.id})}" th:text="${related.name}"></a>
                                </h5>
                                 <div class="product-price">
                                    <a th:href="@{/product/{id}(id=${related.id})}" class="text-decoration-none" data-after="View Details">
                                        <span th:text="'$' + ${#numbers.formatDecimal(related.price, 1, 'COMMA', 2, 'POINT')}"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="swiper-pagination"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <div th:insert="~{index :: #footer}"></div>

    <script th:src="@{/js/jquery.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/plugins.js}"></script>
    <script th:src="@{/js/script.min.js}"></script>
    <script>
        // Simple quantity counter
        document.addEventListener('DOMContentLoaded', function() {
            const plusButton = document.getElementById('button-plus');
            const minusButton = document.getElementById('button-minus');
            const quantityInput = document.getElementById('quantity-input');

            if(plusButton) {
                plusButton.addEventListener('click', function() {
                    let currentValue = parseInt(quantityInput.value);
                    quantityInput.value = currentValue + 1;
                });
            }

            if(minusButton) {
                minusButton.addEventListener('click', function() {
                    let currentValue = parseInt(quantityInput.value);
                    if (currentValue > 1) {
                        quantityInput.value = currentValue - 1;
                    }
                });
            }

            // Initialize related products swiper
            var relatedSwiper = new Swiper(".related-products .product-swiper", {
                slidesPerView: 4,
                spaceBetween: 20,
                loop: true,
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                },
                breakpoints: {
                    0: { slidesPerView: 1, spaceBetween: 20 },
                    576: { slidesPerView: 2, spaceBetween: 20 },
                    992: { slidesPerView: 3, spaceBetween: 20 },
                    1200: { slidesPerView: 4, spaceBetween: 20 },
                },
            });
        });
    </script>
</body>
</html>